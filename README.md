# parser v 2.0
ТЗ тут: https://github.com/mscamarilla/parser/blob/master/README.md

1. **несколько вхождений psr-4 вместо одного, неясно зачем** - непонятен этот пункт. в композере лишняя строчка services, но это не то.

2. **от тестового ожидалась разработка cli комманды, без использования http запроса. незнание $argv, аргументов и опшинов в cli** -. Я и правда этого не знала. Получилось реализовать только жестко заданные аргументы. Было бы красиво, если команда задавалась без ключа, если заданы несколько команд, выполнялась бы первая или последняя, остальные игнорировались. Но реализовать это не получилось
3. **index.php скорее напоминает процедурное программирование вместо ооп** - теперь там пусто, дергается только загрузчик
4. **конкретная “комманда” слабо выражена, лучше для каждой комманды отдельный объект** - связано с предыдущими пунктами, теперь разграничено
5. **использование глобального стейта (константа DOMAIN и её использование в объекте Page)** - Это разве недостаток? На внутренних страницах сайта ссылки могут быть записаны как угодно, с доменом, протоколом или без всего этого. ссылка на главную может иметь вид '/'. При обходе внутренних страниц, им нужно добавить хотя бы домен для того, чтоб их открыть и спарсить, я это и сделала в первой версии. Домен инициализировался при первом обходе и все внутренние страницы использовали эту константу. Во второй версии я не только оставила домен, но добавила еще и протокол глобально. В итоге каждая внутренняя ссылка приводится к единому виду, с протоколом и доменом, но без www. По домену так же определяется внутренняя это ссылка или внешняя.
6. **Сильная свяность объектов Image/Hrefs с Page** - Я подозреваю, что утверждение справедливое, но окончательно запуталась в структуре.
7. **Не понятна ответственность объекта типа Href, с первого взляда это должно быть объектное отображение ссылки, на деле - коллекция ссылок** - Верно, как и Images - коллекция. Почему возникло впечатление, что это должны быть объекты на каждый элемент? потому что я выделила отдельные сущности? Правильным было бы делать каждую ссылку и каждую картинку отдельной сущностью?
8. **Опираясь на п. 7, неясно зачем интерфейс ItemInterface** - в задании написано, что аритектура должна быть расширяема, и будут парситься другие теги. Каждый новый объект-тег должен будет иметь заданный интерфейсом метод get_tags(). Возможно, у меня неправильная структура и это не очевидно. Использование интерфейсов в целом - мне не очень понятно.
9. **Для работы с csv файлами в пхп есть нативные ф-ции** - Есть. переписала на нативные. Разницы не вижу.
10. **Для оптимизации работы с памятью лучше юзать стримы** - абсолютно новая для меня тема, в которую я так быстро не въехала. Нужно больше времени, так что этот пункт я проигнорировала пока
11. **работа с DOM-ом, в пхп есть нативное решение** - Тоже оказалась новая тема, но я ее применила. Использование сущности DOMDocument позволяет не использовать мою Page вообще? но я ее оставила пока, тут мне совет нужен.

Резюме:
1. То, что  вычленение сущностей их связность и архитектура приложения вцелом - мое слабое место, я знала. Очень мало опыта в этом. Нужно набить руку, вероятно. Я знаю, как создать/связать сущности в разных вариациях, но не понимаю, как лучше. В процессе написания кода могу по несколько раз поменять это и теряю время.
2. Потоки - вообще дикий лес, даже не знаю, как к ним подступаться.
3. php и DOM оказалось тоже новым, но, вроде не сложно. Хотя теория какая-то не помешает. 
4. Я заметила, что применяю другие инструменты для некоторых задач, и это считается неправильным. К примеру, я использую регулярные выражения для валидации полей формы, а не filter_var, теги на странице парсила тоже регуляркой. Использовала curl для доступа к сайту, а не php DOM. Это плохо?
5. За константу домен до сих пор обидно. В чем я не права? за запись в csv - отчасти тоже. в чем разница просто записи в файл с заранее известными делимитерами и встроенной функции php?

Заняло еще около 14 часов
***************************************************************************************************
Installation:
1. copy files to server
2. run composer install

Usage:
1. php parser.php -a report -u https://habr.com/ru/post/506902/ -d 2 : shows data from habr.com/ru/post/506902/ with 2 level of depth in console.
2. php parser.php -a parse -u https://habr.com/ru/post/506902/ -d 2 : saves data from habr.com/ru/post/506902/ with 2 level of depth to csv file in root folder.
3. php parser.php -a help - shows help
